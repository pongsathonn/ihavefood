syntax = "proto3";

package ihavefood;

option go_package =  "/genproto";

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "common.proto";


// ---------------------MERCHANT SERVICE------------------------
service MerchantService {

    rpc ListMerchants(google.protobuf.Empty) returns(ListMerchantsResponse){
        option (google.api.http) = {
            get: "/api/merchants" 
        };
    }
    rpc GetMerchant(GetMerchantRequest) returns(Merchant){
        option (google.api.http) = {
            get: "/api/merchants/{merchant_id}" 
        };
    }

    rpc CreateMerchant(CreateMerchantRequest) returns(Merchant){}
    rpc UpdateMerchant(UpdateMerchantRequest) returns(Merchant) {
        option (google.api.http) = {
            patch: "/api/merchants/{merchant_id}"
            body: "*"
        };
    }

    // Menu management
    rpc CreateMenu(CreateMenuRequest) returns(CreateMenuResponse) {
        option (google.api.http) = {
            post: "/api/merchants/{merchant_id}/menu"
            body: "*"
        };
    }

    rpc UpdateMenuItem(UpdateMenuItemRequest) returns(MenuItem) {
        option (google.api.http) = {
            patch: "/api/merchants/{merchant_id}/menu/items/{item_id}"
            body: "*"
        };
    }

    // Store Management
    rpc UpdateStoreStatus(UpdateStoreStatusRequest) returns (StoreStatusResponse);
    rpc GetStoreStatus(GetStoreStatusRequest) returns (StoreStatusResponse);
}

enum StoreStatus{
    CLOSED = 0;
    OPEN = 1;
}

message Merchant {
    string merchant_id = 1;
    string merchant_name = 2;
    repeated MenuItem menu = 3;
    Address address = 4;
    string phone_number = 5;
    StoreStatus status = 6;
}

message MenuItem {
    string item_id = 1;
    string food_name = 2;
    int32 price = 3;
    string description = 4;
    bool is_available = 5;
}

message GetMerchantRequest{
    string merchant_id = 1;
}

message ListMerchantsResponse{
    repeated Merchant merchants = 1;
}

message CreateMerchantRequest {
    string merchant_id = 1;
    string merchant_name = 2;
}

message UpdateMerchantRequest {
    string merchant_id = 1 ;
    string merchant_name = 2;
    repeated MenuItem menu = 3;
    Address address = 4;
}
message CreateMenuRequest {
    string merchant_id = 1;
    repeated MenuItem menu = 2;
}

message CreateMenuResponse {
  repeated MenuItem menu = 1;
}

message UpdateMenuItemRequest {
    string merchant_id = 1;
    string item_id = 2;
    string food_name = 3;
    int32 price = 4;
    string description = 5;
    bool is_available = 6;
}

message UpdateStoreStatusRequest {
    string merchant_id = 1;
    StoreStatus status = 2;
}

message GetStoreStatusRequest {
    string merchant_id = 1;
}
message StoreStatusResponse {
    string merchant_id = 1;
    StoreStatus status = 2;
}
